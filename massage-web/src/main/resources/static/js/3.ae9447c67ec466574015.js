webpackJsonp([3],{O0ye:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Xxa5"),s=n.n(i),a=n("exGp"),c=n.n(a),r=n("mvHQ"),o=n.n(r),l=n("//Fk"),u=n.n(l),d=n("RtM3"),v=n("Fd2+"),m={data:function(){return{userInfo:JSON.parse(localStorage.getItem("userInfo")),showEquipmentPicker:!1,equipment:[],equipmentData:[],searchVal:"",sidebarList:[],list1:[],list2:[],list3:[],sidebarActive:0,second_level_active:0,second_level_active1:0,remainingTime:0,moenyTotal:0}},created:function(){document.title="商家主页",this.getEquipmentList(),this.getProjectList(),this.getMoneyUnsettled()},methods:{getMoneyUnsettled:function(){var e=this;Object(d.g)({businessId:this.userInfo.businessId}).then(function(t){"000000"==t.code&&(e.moenyTotal=t.data,e.getDate())})},getDate:function(){var e=(new Date).getDate()-26;e>=0&&e<3&&0==this.moenyTotal.achievement&&v.a.confirm({title:"提示",message:"美力时间不够了，请尽快给我补充些美力吧。未结算总业绩额："+this.moenyTotal.money+"元  锁机倒计时："+(3-e)+"天"}).then(function(){}).catch(function(){})},openEquipment:function(){this.remainingTime<0?Object(v.c)("设备体验时间已过期！"):Object(d.c)({equipmentId:this.userInfo.equipmentId}).then(function(e){"000000"===e.code?v.c.success("开启成功！"):v.c.fail(e.msg)})},getEquipmentList:function(){var e=this;Object(d.d)({businessId:this.userInfo.businessId,type:1}).then(function(t){"000000"==t.code&&(e.equipment=t.data.map(function(e){return e.equipmentId}),e.equipmentData=t.data,t.data.map(function(t){t.equipmentId==e.userInfo.equipmentId&&(e.remainingTime=t.surplusTime)}))})},getProjectList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this;v.c.loading({duration:0,forbidClick:!0,message:"加载中....."});return new u.a(function(i,s){Object(d.k)({parentId:t}).then(function(s){v.c.clear(),"000000"===s.code&&(s.data.length>0?(0==t&&(s.data.map(function(e){return e.selected=!1}),n.sidebarList=s.data),i(s.data)):e.$router.push({path:"projectDetails",query:{projectId:t}}))})})},equipmentToggle:function(e){var t=this;this.$set(this.userInfo,"equipmentId",e),this.equipmentData.map(function(n){n.equipmentId==e&&(t.remainingTime=n.surplusTime)}),localStorage.setItem("userInfo",o()(this.userInfo)),this.showEquipmentPicker=!1},quitLogin:function(){localStorage.removeItem("userInfo"),this.$router.replace("/")},onSearch:function(e){var t=this;Object(d.l)({projectName:e}).then(function(e){"000000"==e.code?e.data.length>0?t.$router.push({path:"projectDetails",query:{projectId:e.data[0].projectId}}):v.c.fail("暂无搜索内容！"):v.c.fail(e.msg)})},toogleSidebar:function(e,t){var n=this;return c()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.sidebarList.map(function(e){return e.selected=!1}),t.selected=!0,console.log(t.parentId),e.next=5,n.getProjectList(t.projectId);case 5:n.list1=e.sent,n.list2=[],n.list3=[],console.log(n.sidebarList);case 9:case"end":return e.stop()}},e,n)}))()},toggleSecondLevel:function(e,t,n){var i=this;return c()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=n){e.next=9;break}return i.list1.map(function(e){return e.selected=!1}),t.selected=!0,e.next=5,i.getProjectList(t.projectId);case 5:i.list2=e.sent,i.list3=[],e.next=22;break;case 9:if(2!=n){e.next=17;break}return i.list2.map(function(e){return e.selected=!1}),t.selected=!0,e.next=14,i.getProjectList(t.projectId);case 14:i.list3=e.sent,e.next=22;break;case 17:if(3!=n){e.next=22;break}return i.list3.map(function(e){return e.selected=!1}),t.selected=!0,e.next=22,i.getProjectList(t.projectId);case 22:case"end":return e.stop()}},e,i)}))()}}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"business"},[n("div",{staticClass:"business-header"},[n("div",{staticClass:"header-left"},[n("div",{staticClass:"header-left-name"},[n("span",[e._v("店家名称：")]),e._v("\n        "+e._s(e.userInfo.userName)+"\n      ")]),e._v(" "),n("div",{staticClass:"header-equipment"},[n("span",[e._v("设 备：")]),e._v(" "),n("van-field",{attrs:{readonly:"",clickable:"","is-link":"",name:"picker",value:e.userInfo.equipmentId,placeholder:"选择设备"},on:{click:function(t){e.showEquipmentPicker=!0}}}),e._v(" "),n("van-popup",{attrs:{position:"bottom"},model:{value:e.showEquipmentPicker,callback:function(t){e.showEquipmentPicker=t},expression:"showEquipmentPicker"}},[n("van-picker",{attrs:{title:"选择设备","show-toolbar":"",columns:e.equipment},on:{confirm:e.equipmentToggle,cancel:function(t){e.showEquipmentPicker=!1}}})],1)],1)]),e._v(" "),n("div",{staticClass:"header-right"},[n("van-button",{attrs:{color:"linear-gradient(to right, #6F6F6F , #414141)",round:"",block:""},on:{click:e.quitLogin}},[e._v("退出登陆")])],1)]),e._v(" "),n("div",{staticClass:"experience-content"},[n("div",{staticClass:"experience-btn"},[n("van-button",{attrs:{color:"linear-gradient(to right, #6F6F6F , #414141)",round:"",block:""},on:{click:e.openEquipment}},[e._v("体验模式")])],1),e._v(" "),n("div",{staticClass:"experience-date"},[e._v("剩余体验时长："+e._s(e.remainingTime||0)+"分钟")])]),e._v(" "),n("div",{staticClass:"line"}),e._v(" "),n("div",{staticClass:"business-content"},[n("div",{staticClass:"content-search"},[n("van-search",{attrs:{placeholder:"请输入项目名称"},on:{search:e.onSearch},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),n("div",{staticClass:"search-btn"},[n("van-button",{attrs:{color:"linear-gradient(to right, #6F6F6F , #414141)",round:"",block:""},on:{click:function(t){e.onSearch(e.searchVal)}}},[e._v("搜索")])],1)],1),e._v(" "),n("div",{staticClass:"content-list"},[n("div",{staticClass:"list-sidebar"},e._l(e.sidebarList,function(t,i){return n("div",{key:i,staticClass:"sidebar-items",on:{click:function(n){e.toogleSidebar(i,t)}}},[n("div",{class:(t.selected?"active-sidebar-items-name":"")+"    sidebar-items-name"},[e._v(e._s(t.projectName))]),e._v(" "),n("img",{attrs:{src:t.projectImg||"./static/icon.png",alt:""}})])}),0),e._v(" "),n("div",{staticClass:"list-classification"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.list1.length>0,expression:"list1.length>0"}],staticClass:"second_level_title"},[e._v("二级分类")]),e._v(" "),n("div",{staticClass:"second_level_content"},e._l(e.list1,function(t,i){return n("div",{key:i,staticClass:"second_level_items"},[n("van-button",{attrs:{color:t.selected?"linear-gradient(to right, #EFEFEF , #D7D7D7)":"linear-gradient(to right, #6F6F6F , #414141)",round:"",block:""},on:{click:function(n){e.toggleSecondLevel(i,t,1)}}},[e._v(e._s(t.projectName))])],1)}),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.list2.length>0,expression:"list2.length>0"}],staticClass:"second_level_title"},[e._v("三级分类")]),e._v(" "),n("div",{staticClass:"level_three_content"},e._l(e.list2,function(t,i){return n("div",{key:i,staticClass:"level_three_items"},[n("van-button",{attrs:{color:t.selected?"linear-gradient(to right, #EFEFEF , #D7D7D7)":"linear-gradient(to right, #6F6F6F , #414141)",round:"",block:""},on:{click:function(n){e.toggleSecondLevel(i,t,2)}}},[e._v(e._s(t.projectName))])],1)}),0),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.list3.length>0,expression:"list3.length>0"}],staticClass:"second_level_title"},[e._v("四级分类")]),e._v(" "),n("div",{staticClass:"level_three_content"},e._l(e.list3,function(t,i){return n("div",{key:i,staticClass:"level_three_items"},[n("van-button",{attrs:{color:t.selected?"linear-gradient(to right, #EFEFEF , #D7D7D7)":"linear-gradient(to right, #6F6F6F , #414141)",round:"",block:""},on:{click:function(n){e.toggleSecondLevel(i,t,3)}}},[e._v(e._s(t.projectName))])],1)}),0)])])])])},staticRenderFns:[]};var h=n("VU/8")(m,p,!1,function(e){n("Z5eP")},null,null);t.default=h.exports},Z5eP:function(e,t){},mvHQ:function(e,t,n){e.exports={default:n("qkKv"),__esModule:!0}},qkKv:function(e,t,n){var i=n("FeBl"),s=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}}});
//# sourceMappingURL=3.ae9447c67ec466574015.js.map